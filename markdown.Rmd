---
title: "Homework 5"
author: "Vincent Tam"
date: "November 3, 2018"
output: github_document
---

```{r Problem 1, setup, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE}
library(tidyverse, rvest)
library(janitor)
library(dplyr, purrr, ggplot)
library(data.table)
conexp = data_frame(ArmID = list.files(path = "data")) %>%
  mutate(ArmID = as.character(ArmID)) %>%
  mutate(ArmID = str_replace(ArmID, ".csv", "")) %>%
  mutate(ArmID = str_replace(ArmID, "_", ""))
data = map(list.files(path = "data", full.names = TRUE), read_csv, col_names = TRUE) 
data = bind_rows(data, .id = NULL) 
complete = bind_cols(conexp, data) %>%
  clean_names() 
names(complete) <- gsub("\\_", "", names(complete))
complete
gather(complete, key = week, value = obs, week1:week8) %>%
ggplot(aes(week, obs, color = armid, group = armid)) + geom_point() + geom_line() + labs(title = "Control vs Experimental, Week 1-8", x = "Week", y = "Observations")
```
```{r Problem 2}
library(dplyr)
library(janitor)
library(purrr)
X <- read.csv(url("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv"))
X = 
  X %>%
  unite(city_state, city, state)
## summarize within cities to obtain total number of homicides and unsolved homicides
## purrr to subset using nest
## using MAP to loop in total homicides and unsolved homicides within each unique city/state
dispo = 
  X %>%
  select(city_state, disposition) 
homicides =
  dispo %>%
  filter(disposition == "Closed by arrest") %>%
  group_by(city_state) %>%
  summarize(total_solved = n())
unsolved =
  dispo %>%
  filter(disposition == "Closed without arrest" | disposition == "Open/No arrest") %>%
  group_by(city_state) %>%
  summarize(total_unsolved = n())
## prop test for MD
baltimore_total =
  dispo %>%
  filter(city_state == "Baltimore_MD") %>%
  summarize(total_homicide = n())
baltimore_total
baltimore_solved =
  homicides %>%
  filter(city_state == "Baltimore_MD")
baltimore_solved
baltimore_unsolved = 
  unsolved %>%
  filter(city_state == "Baltimore_MD")
baltimore_unsolved



```


